# C# 字符串拼接

在 C# 中，有多种方法可以将多个字符串连接（拼接）起来。选择哪种方法取决于具体的需求，例如代码可读性、性能等。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>

## 1. 使用 `+` 或 `+=` 运算符

这是最简单直观的字符串拼接方式。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/bullzerone/article/details/72629852" index="1">1</mcreference>

- 当连接字符串字面量或常量时，拼接操作在编译时完成，运行时没有性能开销。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>
- 当连接字符串变量时，拼接操作在运行时进行。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> 每次使用 `+` 或 `+=` 连接字符串变量时，都会在内存中创建一个新的字符串对象。 <mcreference link="https://www.cnblogs.com/cad2/p/4386048.html" index="3">3</mcreference> <mcreference link="https://blog.csdn.net/wcc27857285/article/details/88966411" index="4">4</mcreference> 对于少量拼接操作，这种方式很方便，但如果在循环中进行大量拼接，可能会导致性能问题。 <mcreference link="https://www.cnblogs.com/cad2/p/4386048.html" index="3">3</mcreference> <mcreference link="https://blog.csdn.net/wcc27857285/article/details/88966411" index="4">4</mcreference>

```csharp
string firstName = "John";
string lastName = "Doe";

// 使用 + 运算符
string fullName = "My name is " + firstName + " " + lastName + ".";
Console.WriteLine(fullName); // 输出: My name is John Doe.

// 使用 += 运算符
string message = "Hello";
message += " ";
message += firstName;
message += "!";
Console.WriteLine(message); // 输出: Hello John!
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>

## 2. 字符串内插 (`$`) (C# 6.0+)

字符串内插提供了一种更简洁、可读性更高的方式来构建字符串。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/wcc27857285/article/details/88966411" index="4">4</mcreference> 它允许你将表达式直接嵌入到字符串字面量中。

```csharp
string name = "Alice";
int age = 30;

string greeting = $"Hello, my name is {name} and I am {age} years old.";
Console.WriteLine(greeting); // 输出: Hello, my name is Alice and I am 30 years old.
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://www.modb.pro/db/153901" index="5">5</mcreference>

## 3. `string.Format()`

`string.Format()` 方法允许你使用占位符（如 `{0}`, `{1}`）来格式化字符串，然后用指定的值替换这些占位符。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/wcc27857285/article/details/88966411" index="4">4</mcreference>

```csharp
string item = "apples";
int quantity = 5;

string formattedString = string.Format("I need {1} {0}.", item, quantity);
Console.WriteLine(formattedString); // 输出: I need 5 apples.
```
在内部，`string.Format()` 通常会使用 `StringBuilder` 来提高效率。 <mcreference link="https://www.cnblogs.com/cad2/p/4386048.html" index="3">3</mcreference>

## 4. `StringBuilder` 类

当需要在循环中或进行大量字符串拼接操作时，`StringBuilder` 类是最高效的选择。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://www.cnblogs.com/cad2/p/4386048.html" index="3">3</mcreference> `StringBuilder` 对象是可变的，它在内部维护一个缓冲区，并在需要时自动扩展，从而避免了像 `+` 运算符那样频繁创建新字符串对象的开销。

```csharp
using System.Text; // 需要引入 System.Text 命名空间

StringBuilder sb = new StringBuilder();
sb.Append("This ");
sb.Append("is ");
sb.Append("a ");
sb.Append("sentence ");
sb.Append("built ");
sb.Append("with ");
sb.AppendLine("StringBuilder."); // AppendLine 会在末尾添加换行符

for (int i = 0; i < 5; i++)
{
    sb.AppendFormat("Number: {0}\n", i);
}

string result = sb.ToString();
Console.WriteLine(result);
/*
输出:
This is a sentence built with StringBuilder.
Number: 0
Number: 1
Number: 2
Number: 3
Number: 4
*/
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://www.cnblogs.com/cad2/p/4386048.html" index="3">3</mcreference>

## 5. `string.Concat()`

`string.Concat()` 是一个静态方法，可以将多个字符串或对象（会调用其 `ToString()` 方法）连接起来。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/bullzerone/article/details/72629852" index="1">1</mcreference>

```csharp
string s1 = "Hello";
string s2 = " ";
string s3 = "World";
int num = 123;

string concatenatedString = string.Concat(s1, s2, s3, "! Value: ", num);
Console.WriteLine(concatenatedString); // 输出: Hello World! Value: 123

string[] words = { "The", "quick", "brown", "fox" };
string phrase = string.Concat(words);
Console.WriteLine(phrase); // 输出: Thequickbrownfox
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/bullzerone/article/details/72629852" index="1">1</mcreference>

## 6. `string.Join()`

`string.Join()` 方法用于将一个字符串数组或集合的元素连接起来，并在每个元素之间插入一个指定的分隔符。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference> <mcreference link="https://blog.csdn.net/bullzerone/article/details/72629852" index="1">1</mcreference>

```csharp
string[] elements = { "apple", "banana", "cherry" };

string joinedWithComma = string.Join(", ", elements);
Console.WriteLine(joinedWithComma); // 输出: apple, banana, cherry

string joinedWithDash = string.Join("-", elements);
Console.WriteLine(joinedWithDash); // 输出: apple-banana-cherry
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>

## 7. LINQ `Aggregate` 方法

对于集合中的字符串，还可以使用 LINQ 的 `Aggregate` 方法进行拼接。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>

```csharp
using System.Linq;

string[] wordsArray = { "The", "quick", "brown", "fox" };
string aggregatedPhrase = wordsArray.Aggregate((current, next) => current + " " + next);
Console.WriteLine(aggregatedPhrase); // 输出: The quick brown fox
```
<mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>
需要注意的是，这种方法在每次迭代时可能会创建中间字符串，如果性能是关键考虑因素，可能不如 `StringBuilder` 或 `string.Join` 高效。 <mcreference link="https://learn.microsoft.com/zh-cn/dotnet/csharp/how-to/concatenate-multiple-strings" index="2">2</mcreference>

## 总结与选择

- **简单拼接 (少量字符串)**: `+` 运算符或字符串内插 (`$`) 通常是最清晰和方便的。
- **格式化输出**: `string.Format()` 或字符串内插 (`$`) 非常适合。
- **大量拼接 (尤其在循环中)**: `StringBuilder` 是性能最佳的选择。
- **连接数组/集合元素**: `string.Join()` 是首选，如果需要自定义聚合逻辑，可以考虑 `Aggregate`。
- **通用拼接**: `string.Concat()` 提供了灵活的拼接方式。

选择哪种方法取决于具体的场景和对性能、可读性的权衡。